<!-- projects.component.html -->
<section id="portfolio" class="py-20 bg-gray-100">
  <div class="container mx-auto px-6">
    <!-- Section Title -->
    <h2 class="text-4xl font-bold text-center mb-4">Realisations</h2>
    <p class="text-center text-gray-600 mb-10">Quelques une de mes réalisations</p>

    <!-- Grid Projects -->
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
      <div *ngFor="let project of projects" class="bg-white shadow-md rounded overflow-hidden group relative">
        
        <!-- Affichage image -->
        <div *ngIf="!project.image.endsWith('.webm')" class="w-full h-48 bg-gray-200 overflow-hidden">
          <img [src]="project.image" [alt]="project.title" class="w-full h-full object-cover transition-all duration-300" />
        </div>

        <!-- Vidéo pour les projets -->
        <div *ngIf="project.image.endsWith('.webm')" class="w-full h-48 bg-gray-200 relative overflow-hidden">
          <video class="w-full h-full object-cover" [src]="project.image" muted loop autoplay></video>
          <button (click)="openVideoModal(project.image)" class="absolute inset-0 flex justify-center items-center bg-black bg-opacity-50 text-white font-bold text-lg hover:bg-opacity-60 transition-all">
            ▶ Voir la vidéo
          </button>
        </div>

        <!-- Titre du projet -->
        <div class="p-4">
          <h3 class="font-bold text-lg">{{ project.title }}</h3>
        </div>

        <!-- Boutons pour les projets avec image -->
        <div *ngIf="!project.image.endsWith('.webm')" class="absolute inset-0 flex flex-col justify-center items-center bg-black bg-opacity-50 opacity-0 group-hover:opacity-100 transition-opacity duration-300">
          <a *ngIf="project.siteUrl" [href]="project.siteUrl" target="_blank" class="text-white bg-blue-500 px-4 py-2 my-1 rounded-md hover:bg-blue-600">Voir le site</a>
          <a *ngIf="project.gtihubURL" [href]="project.gtihubURL" target="_blank" class="text-white bg-green-500 px-4 py-2 my-1 rounded-md hover:bg-green-600">Voir le code</a>
          <button (click)="openModal(project)" class="text-white bg-red-500 px-4 py-2 my-1 rounded-md hover:bg-red-600">Voir Détail</button>
        </div>

        <!-- Boutons pour les projets avec vidéo -->
        <div *ngIf="project.image.endsWith('.webm')" class="p-4 bg-gray-50">
          <button (click)="openModal(project)" class="w-full text-white bg-red-500 px-4 py-2 rounded-md hover:bg-red-600">Voir Détail</button>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Modal pour les vidéos -->
<div *ngIf="videoModalVisible" class="fixed inset-0 flex justify-center items-center bg-black bg-opacity-75 z-50" (click)="closeModal()">
  <div class="bg-white rounded-lg overflow-hidden shadow-xl max-w-4xl w-11/12" (click)="$event.stopPropagation()">
    <video #videoPlayer controls autoplay class="w-full">
      <source [src]="videoSrc" type="video/webm" />
      Votre navigateur ne prend pas en charge ce format vidéo.
    </video>
    <div class="flex justify-end p-4">
      <button (click)="closeModal()" class="bg-red-500 text-white px-4 py-2 rounded-md hover:bg-red-600">Fermer</button>
    </div>
  </div>
</div>

<!-- Popup Modal pour les détails -->
<div *ngIf="modalVisible" class="fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-40" (click)="closeModal()">
  <div class="bg-white w-11/12 md:w-2/3 lg:w-1/3 rounded-lg shadow-lg overflow-hidden" (click)="$event.stopPropagation()">
    <!-- Modal Header -->
    <div class="bg-blue-500 text-white px-4 py-2 flex justify-between items-center">
      <h3 class="font-bold text-lg">{{ modalTitle }}</h3>
      <button class="text-white font-bold text-xl hover:text-gray-200" (click)="closeModal()">×</button>
    </div>
    <!-- Modal Body -->
    <div class="p-4">
      <p class="text-gray-700 mb-4">{{ modalDescription }}</p>
      <p class="text-gray-500"><strong>Langages utilisés :</strong> {{ modalLanguages }}</p>
    </div>
    <!-- Modal Footer -->
    <div class="flex justify-end px-4 py-2 bg-gray-100">
      <button class="bg-red-500 text-white px-4 py-2 rounded-md hover:bg-red-600" (click)="closeModal()">Fermer</button>
    </div>
  </div>
</div>